#
# This file is part of the Kintun - Restful Vulnerability Scanner
#
# (c) CERT UNLP <support@cert.unlp.edu.ar>
#
# This source file is subject to the GPL v3.0 license that is bundled
# with this source code in the file LICENSE.
#

from ..scan import Scan

class HttpGoogleMalware(Scan):
	name = "httpgooglemalware"

	def __init__(self, *initial_data, **kwargs):
		Scan.__init__(self, initial_data, kwargs)

	@classmethod
	def getName(cls):
		return cls.name

# nmnmap -p80 --script http-google-malware <host>
	def getCommand(self):
		command = []
		command += ["nmap"]
		#command += ["-v3"]
		command += ["-Pn"]
		#command = self.addCommandPorts(command,self.ports)
		#no funciona con script del sistema, solo con path parcial
		command += ["--script="+self.getNseFolder()+"http-google-malware.nse"]
		command += [self.network]
		command += ["-oX="+self.getOutputXmlFilePath()]
		return command

	#def addCommandPorts(self, command, ports):
	#	return command + ["-p "+','.join(ports)]

	def prepareOutput(self, data):
		return self.parseAsNmapScript(data)

	def getTypeNGEN(self):
		return "malware"

	#def getDefaultPorts(self):
	#	return ["123"]
